<!-- Mobile Layout -->
<GridLayout rows="auto, auto, auto, *" height="100%" width="100%" class="mobile-container">
    <!-- ActionBar -->
    <ActionBar row="0" class="action-bar">
        <NavigationButton visibility="hidden"></NavigationButton>
        <GridLayout columns="50, *">
            <Label class="action-bar-title" text="é£Ÿå“ç®¡ç†" colSpan="2"></Label>
            <Label class="fas" text="&#xf0c9;" (tap)="onDrawerButtonTap()"></Label>
        </GridLayout>
    </ActionBar>
    
    <!-- Top Header -->
    <GridLayout row="1" columns="auto, *, auto, auto" class="mobile-header">
        <Label col="0" text="ðŸŽ" class="app-icon"></Label>
        <StackLayout col="1" class="header-info">
            <Label text="é£Ÿå“ç®¡ç†" class="page-title"></Label>
            <Label [text]="getConnectionStatus()" [class]="'connection-status ' + getConnectionStatusClass()"></Label>
        </StackLayout>
        <Button col="2" text="ðŸ”" (tap)="onSearch()" class="action-btn" hint="æœå°‹"></Button>
        <Button col="3" text="ðŸ”„" (tap)="onSync()" class="sync-btn" [class.loading]="isLoading"></Button>
    </GridLayout>
    
    <!-- Tab Navigation -->
    <GridLayout row="2" columns="*, *, auto, auto" class="tab-navigation">
        <Button col="0" [text]="'ðŸ“‹ æ¸…å–® (' + foodItems.length + ')'" 
                [class]="'tab-btn ' + (activeTab === 'list' ? 'active' : '')" 
                (tap)="setActiveTab('list')"></Button>
        <Button col="1" text="âž• æ–°å¢ž" 
                [class]="'tab-btn ' + (activeTab === 'add' ? 'active' : '')" 
                (tap)="setActiveTab('add')"></Button>
        <Button col="2" text="ðŸ·ï¸" (tap)="onFilterByCategory()" class="filter-btn" hint="åˆ†é¡žç¯©é¸"></Button>
        <Button col="3" text="âš ï¸" (tap)="onCheckExpiring()" class="warning-btn" hint="å³å°‡åˆ°æœŸ"></Button>
    </GridLayout>
    
    <!-- Loading Indicator -->
    <StackLayout row="3" *ngIf="isLoading" class="loading-container">
        <Label text="è¼‰å…¥ä¸­..." class="loading-text"></Label>
        <ActivityIndicator busy="true" class="loading-spinner"></ActivityIndicator>
    </StackLayout>
    
    <!-- Content Area -->
    <GridLayout row="3" *ngIf="!isLoading" class="content-area">
        <!-- Food List View -->
        <ScrollView *ngIf="activeTab === 'list'" class="food-list-view">
            <StackLayout class="food-items-mobile">
                <GridLayout *ngFor="let item of foodItems" columns="auto, *, auto" class="food-item-mobile" (tap)="onItemTap(item)">
                    <!-- Product Image -->
                    <StackLayout col="0" class="product-image-mobile">
                        <Image [src]="item.image" stretch="aspectFill" *ngIf="item.image" class="product-img-mobile"></Image>
                        <Label text="ðŸ“¦" class="placeholder-icon-mobile" *ngIf="!item.image"></Label>
                    </StackLayout>
                    
                    <!-- Product Details -->
                    <StackLayout col="1" class="product-details-mobile">
                        <Label [text]="item.name" class="product-name-mobile" textWrap="true"></Label>
                        <GridLayout columns="auto, auto, *" class="product-meta-mobile">
                            <Label col="0" [text]="'æ•¸é‡: ' + item.amount" class="meta-text-mobile"></Label>
                            <Label col="1" [text]="'NT$' + item.price" class="meta-text-mobile price-mobile" *ngIf="item.price > 0"></Label>
                        </GridLayout>
                        <Label [text]="'åˆ°æœŸ: ' + item.expiryDate" class="expiry-date-mobile"></Label>
                        <GridLayout columns="auto, auto" *ngIf="item.shop || item.category">
                            <Label col="0" [text]="item.shop" class="shop-name-mobile" *ngIf="item.shop"></Label>
                            <Label col="1" [text]="'#' + item.category" class="category-tag-mobile" *ngIf="item.category"></Label>
                        </GridLayout>
                    </StackLayout>
                    
                    <!-- Action Button -->
                    <StackLayout col="2" class="action-btn-container-mobile">
                        <Button text="ðŸ—‘ï¸" (tap)="onDelete(item)" class="delete-btn-mobile"></Button>
                    </StackLayout>
                </GridLayout>
                
                <!-- Empty State -->
                <StackLayout *ngIf="foodItems.length === 0" class="empty-state">
                    <Label text="ðŸ“¦" class="empty-icon"></Label>
                    <Label text="å°šç„¡é£Ÿå“è³‡æ–™" class="empty-text"></Label>
                    <Label text="é»žæ“Šä¸Šæ–¹ã€Œæ–°å¢žã€é–‹å§‹æ·»åŠ " class="empty-hint"></Label>
                    <Button text="é‡æ–°è¼‰å…¥" (tap)="onSync()" class="reload-btn"></Button>
                </StackLayout>
            </StackLayout>
        </ScrollView>
        
        <!-- Add Food Form -->
        <ScrollView *ngIf="activeTab === 'add'" class="add-food-view">
            <StackLayout class="form-content-mobile">
                <!-- Name Field -->
                <StackLayout class="form-group-mobile">
                    <Label text="é£Ÿå“åç¨± *" class="form-label-mobile"></Label>
                    <TextField [(ngModel)]="newName" hint="è«‹è¼¸å…¥é£Ÿå“åç¨±" class="form-input-mobile"></TextField>
                </StackLayout>
                
                <!-- Amount and Price Row -->
                <GridLayout columns="*, 15, *" class="form-group-mobile">
                    <StackLayout col="0">
                        <Label text="æ•¸é‡ *" class="form-label-mobile"></Label>
                        <TextField [(ngModel)]="newAmount" keyboardType="number" hint="1" class="form-input-mobile"></TextField>
                    </StackLayout>
                    
                    <StackLayout col="2">
                        <Label text="åƒ¹æ ¼ (NT$)" class="form-label-mobile"></Label>
                        <TextField [(ngModel)]="newPrice" keyboardType="number" hint="0" class="form-input-mobile"></TextField>
                    </StackLayout>
                </GridLayout>
                
                <!-- Expiry Date -->
                <StackLayout class="form-group-mobile">
                    <Label text="åˆ°æœŸæ—¥æœŸ *" class="form-label-mobile"></Label>
                    <GridLayout columns="*, 10, *, 10, *" class="date-inputs-mobile">
                        <TextField col="0" [(ngModel)]="newDateYear" keyboardType="number" hint="å¹´" class="form-input-mobile date-input-mobile"></TextField>
                        <TextField col="2" [(ngModel)]="newDateMonth" keyboardType="number" hint="æœˆ" class="form-input-mobile date-input-mobile"></TextField>
                        <TextField col="4" [(ngModel)]="newDateDay" keyboardType="number" hint="æ—¥" class="form-input-mobile date-input-mobile"></TextField>
                    </GridLayout>
                </StackLayout>
                
                <!-- Shop and Category Row -->
                <GridLayout columns="*, 15, *" class="form-group-mobile">
                    <StackLayout col="0">
                        <Label text="è³¼è²·å•†åº—" class="form-label-mobile"></Label>
                        <TextField [(ngModel)]="newShop" hint="å•†åº—åç¨±" class="form-input-mobile"></TextField>
                    </StackLayout>
                    
                    <StackLayout col="2">
                        <Label text="é¡žåˆ¥" class="form-label-mobile"></Label>
                        <TextField [(ngModel)]="newCategory" hint="é›¶é£Ÿ/é£²å“/ä¸»é£Ÿ" class="form-input-mobile"></TextField>
                    </StackLayout>
                </GridLayout>
                
                <!-- Description Field -->
                <StackLayout class="form-group-mobile">
                    <Label text="å•†å“èªªæ˜Ž" class="form-label-mobile"></Label>
                    <TextView [(ngModel)]="newDescription" hint="å•†å“æè¿°æˆ–å‚™è¨»" class="form-textarea-mobile"></TextView>
                </StackLayout>
                
                <!-- Photo Field -->
                <StackLayout class="form-group-mobile">
                    <Label text="å•†å“åœ–ç‰‡" class="form-label-mobile"></Label>
                    <Button text="ðŸ“· é¸æ“‡åœ–ç‰‡" (tap)="onSelectPhoto()" class="photo-btn-mobile"></Button>
                </StackLayout>
                
                <!-- Action Buttons -->
                <GridLayout columns="*, 15, *" class="action-buttons-mobile">
                    <Button col="0" text="æ¸…é™¤" (tap)="onClear()" class="clear-btn-mobile"></Button>
                    <Button col="2" text="æ–°å¢žé£Ÿå“" (tap)="onAdd()" class="add-btn-mobile"></Button>
                </GridLayout>
                
                <!-- Contentful Notice -->
                <StackLayout class="contentful-notice">
                    <Label text="ðŸ’¡ æç¤º" class="notice-title"></Label>
                    <Label text="ç›®å‰æ–°å¢žçš„é£Ÿå“åƒ…ä¿å­˜åœ¨æœ¬åœ°ã€‚è‹¥è¦åŒæ­¥åˆ° Contentfulï¼Œè«‹è¨­ç½® Management APIã€‚" 
           class="notice-text" textWrap="true"></Label>
                </StackLayout>
            </StackLayout>
        </ScrollView>
    </GridLayout>
</GridLayout>